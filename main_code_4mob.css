/* =========================================================
   SHIKIMORI THEME: "Kuroglass" (File 4)
   Role: Mobile + touch UX + performance
   Keeps glass vibe but reduces blur, heavy shadows, hover-only effects
   ========================================================= */

@media screen and (max-width: 1024px){

  /* -------------------------
     1) Global mobile tuning
     ------------------------- */
  :root{
    /* reduce expensive effects on mobile */
    --glass-alpha: 0.62;     /* slightly more opaque for readability */
    --glass-strong: 0.76;

    /* softer radii for small screens */
    --r-lg: 16px;
    --r-md: 13px;
    --r-sm: 11px;

    /* lower wallpaper distraction */
    --wallpaper-dim: 0.62;
    --wallpaper-blur: 0px;
  }

  body{
    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;
  }

  /* Disable heavy animation feel on mobile, keep it subtle */
  body:after{
    animation-duration: 28s;
  }

  /* -------------------------
     2) Reduce blur cost
     On mobile, keep "glass" via opacity + stroke, minimal blur
     ------------------------- */
  .l-page,
  .block,
  .popup-content,
  .b-topic > .inner,
  .b-comment > .inner,
  .b-dialog > .inner,
  .b-message > .inner,
  .l-top_menu-v2{
    backdrop-filter: blur(10px) saturate(1.08) !important;
    -webkit-backdrop-filter: blur(10px) saturate(1.08) !important;
  }

  /* In case some devices lag, you can drop blur even more */
  @supports not ((backdrop-filter: blur(1px)) or (-webkit-backdrop-filter: blur(1px))){
    .l-page,
    .block,
    .popup-content,
    .b-topic > .inner,
    .b-comment > .inner,
    .b-dialog > .inner,
    .b-message > .inner,
    .l-top_menu-v2{
      backdrop-filter: none !important;
      -webkit-backdrop-filter: none !important;
    }
  }

  /* -------------------------
     3) Cards spacing + edges
     ------------------------- */
  .l-page{
    margin: 58px 10px 18px !important;
    border-radius: var(--r-lg) !important;
    box-shadow: 0 14px 40px rgba(0,0,0,.38) !important;
  }

  .block,
  .popup-content,
  .b-topic > .inner,
  .b-comment > .inner,
  .b-dialog > .inner,
  .b-message > .inner{
    border-radius: var(--r-lg) !important;
    box-shadow: 0 14px 38px rgba(0,0,0,.34) !important;
    transform: none !important; /* hover lift removed on touch */
  }

  /* kill hover-only transforms that can look jumpy on tap */
  .block:hover,
  .b-topic > .inner:hover,
  .b-comment > .inner:hover,
  .b-dialog > .inner:hover,
  .b-message > .inner:hover{
    transform: none !important;
  }

  /* -------------------------
     4) Top menu (thumb-friendly)
     ------------------------- */
  .l-top_menu-v2{
    top: 0;
    position: sticky;
    background: rgba(var(--menu-back), .62) !important;
    border-bottom: 1px solid rgba(var(--line), .12) !important;
    box-shadow: 0 12px 34px rgba(0,0,0,.35) !important;
  }

  /* Make tap targets larger */
  .l-top_menu-v2 .menu-icon,
  .l-top_menu-v2 .menu-dropdown > span,
  .l-top_menu-v2 a{
    min-height: 40px;
    padding-top: 8px;
    padding-bottom: 8px;
    border-radius: 14px !important;
  }

  /* Submenu: no hover animation dependence, stable open */
  .l-top_menu-v2 .menu-dropdown .submenu{
    border-radius: 16px !important;
    background: rgba(var(--block-color), .78) !important;
    border: 1px solid rgba(var(--line), .12) !important;
    box-shadow: 0 22px 60px rgba(0,0,0,.55) !important;

    transform: none !important;
    opacity: 1 !important;
    pointer-events: auto !important;
  }

  /* Search input easier on small screens */
  .l-top_menu-v2 .global-search input{
    border-radius: 16px !important;
    min-height: 40px;
    font-size: 16px !important; /* avoids iOS zoom */
  }

  /* -------------------------
     5) Typography scale
     ------------------------- */
  header.head h1,
  header.head h2{
    letter-spacing: .15px;
  }

  * .c-brief header.head h1{
    font-size: 28px !important;
    line-height: 32px !important;
  }

  /* -------------------------
     6) Buttons and inputs for touch
     ------------------------- */
  .b-link_button,
  .b-button,
  .b-form input[type="submit"],
  button{
    min-height: 42px;
    padding: 10px 14px !important;
    border-radius: 999px !important;
    box-shadow: 0 14px 32px rgba(0,0,0,.38) !important;
    transform: none !important;
  }

  .b-link_button:hover,
  .b-button:hover,
  .b-form input[type="submit"]:hover,
  button:hover{
    transform: none !important;
    filter: none !important;
  }

  .b-link_button:active,
  .b-button:active,
  .b-form input[type="submit"]:active,
  button:active{
    transform: scale(.98) !important; /* tap feedback */
  }

  input[type="text"],
  input[type="email"],
  input[type="number"],
  textarea,
  select{
    min-height: 42px;
    font-size: 16px !important; /* avoids iOS zoom */
    border-radius: var(--r-md) !important;
    background: rgba(var(--input-color), .42) !important;
  }

  textarea{
    min-height: 110px;
  }

  /* -------------------------
     7) Topic avatars and posters
     Remove hover lift, keep clean rounded look
     ------------------------- */
  .b-topic > .inner header img,
  .b-comment > .inner header img{
    border-radius: 14px !important;
    transform: none !important;
    filter: none !important;
    box-shadow: 0 12px 28px rgba(0,0,0,.32) !important;
  }

  .b-topic > .inner header img:hover,
  .b-comment > .inner header img:hover{
    transform: none !important;
  }

  /* -------------------------
     8) Catalog grid tuning
     Make cards breathe and avoid cramped layout
     ------------------------- */
  .b-catalog_entry,
  .b-catalog_entry .cover,
  .b-catalog_entry .image-cutter{
    border-radius: 16px !important;
  }

  .b-catalog_entry .title{
    color: rgba(var(--white-color), 1) !important;
  }

  /* status corner marker from file 3: keep but tone down */
  .b-catalog_entry .image-decor::after{
    box-shadow: 0 10px 22px rgba(0,0,0,.32) !important;
  }

  /* -------------------------
     9) Spoilers / expand chips
     Easier tap, no hover dependence
     ------------------------- */
  .b-height_shortener .expand span,
  .b-log_entry .spoiler.collapse span,
  .b-log_entry .spoiler.collapsed span,
  .b-comment .b-height_shortener .expand span{
    min-height: 36px;
    padding: 8px 12px !important;
    border-radius: 999px !important;
  }

  /* -------------------------
     10) Add to list controls
     On mobile they must be easy to tap
     ------------------------- */
  .b-add_to_list .trigger,
  .b-add_to_list .option{
    min-height: 42px;
    border-radius: 14px !important;
  }

  .b-add_to_list .expanded-options{
    border-radius: 16px !important;
  }

  /* -------------------------
     11) Reduce clutter in footer badge on mobile
     ------------------------- */
  .l-footer:before{
    display: none !important;
  }
}

/* ---------------------------------------------------------
   Ultra small phones
   --------------------------------------------------------- */
@media screen and (max-width: 480px){
  .l-page{
    margin: 54px 8px 16px !important;
  }

  * .c-brief header.head h1{
    font-size: 26px !important;
    line-height: 30px !important;
  }

  .l-top_menu-v2 .global-search input{
    min-height: 42px;
  }

  /* slightly stronger dim for readability */
  :root{
    --wallpaper-dim: 0.68;
  }
}

/* ---------------------------------------------------------
   Prefer-reduced-motion
   --------------------------------------------------------- */
@media (prefers-reduced-motion: reduce){
  *{
    animation: none !important;
    transition: none !important;
    scroll-behavior: auto !important;
  }
  body:after{
    animation: none !important;
  }
}
